!function webpackUniversalModuleDefinition(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash"),require("react")):"function"==typeof define&&define.amd?define(["_","react"],e):"object"==typeof exports?exports["storm-react-diagrams"]=e(require("lodash"),require("react")):t["storm-react-diagrams"]=e(t._,t.React)}("undefined"!=typeof self?self:this,function(t,e){return function(t){function __webpack_require__(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,o){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=11)}([function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(3),r=o(0),s=function(t){function PointModel(e,o){var n=t.call(this)||this;return n.x=o.x,n.y=o.y,n.link=e,n}return n(PointModel,t),PointModel.prototype.getSelectedEntities=function(){return t.prototype.isSelected.call(this)&&!this.isConnectedToPort()?[this]:[]},PointModel.prototype.isConnectedToPort=function(){return null!==this.link.getPortForPoint(this)},PointModel.prototype.deSerialize=function(e){t.prototype.deSerialize.call(this,e),this.x=e.x,this.y=e.y},PointModel.prototype.serialize=function(){return r.merge(t.prototype.serialize.call(this),{x:this.x,y:this.y})},PointModel.prototype.remove=function(){this.link&&this.link.removePoint(this),t.prototype.remove.call(this)},PointModel.prototype.updateLocation=function(t){this.x=t.x,this.y=t.y},PointModel.prototype.getX=function(){return this.x},PointModel.prototype.getY=function(){return this.y},PointModel.prototype.getLink=function(){return this.link},PointModel.prototype.isLocked=function(){return t.prototype.isLocked.call(this)||this.getLink().isLocked()},PointModel}(i.BaseModel);e.PointModel=s},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=o(5),s=o(0),a=function(t){function BaseModel(e,o){var n=t.call(this,o)||this;return n.type=e,n.selected=!1,n}return n(BaseModel,t),BaseModel.prototype.getSelectedEntities=function(){return this.isSelected()?[this]:[]},BaseModel.prototype.deSerialize=function(e){t.prototype.deSerialize.call(this,e),this.type=e.type,this.selected=e.selected},BaseModel.prototype.serialize=function(){return s.merge(t.prototype.serialize.call(this),{type:this.type,selected:this.selected})},BaseModel.prototype.getType=function(){return this.type},BaseModel.prototype.getID=function(){return this.id},BaseModel.prototype.isSelected=function(){return this.selected},BaseModel.prototype.setSelected=function(t){void 0===t&&(t=!0),this.selected=t,this.iterateListeners(function(e,o){e.selectionChanged&&e.selectionChanged(i({},o,{isSelected:t}))})},BaseModel.prototype.remove=function(){this.iterateListeners(function(t,e){t.entityRemoved&&t.entityRemoved(e)})},BaseModel}(r.BaseEntity);e.BaseModel=a},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(3),r=o(0),s=function(t){function NodeModel(e,o){void 0===e&&(e="default");var n=t.call(this,e,o)||this;return n.x=0,n.y=0,n.extras={},n.ports={},n}return n(NodeModel,t),NodeModel.prototype.setPosition=function(t,e){var o=this,n=this.x,i=this.y,s=this;for(var a in this.ports)!function(a){r.forEach(s.ports[a].getLinks(),function(r){var s=r.getPointForPort(o.ports[a]);s.x=s.x+t-n,s.y=s.y+e-i})}(a);this.x=t,this.y=e},NodeModel.prototype.getSelectedEntities=function(){var e=this,o=t.prototype.getSelectedEntities.call(this);if(this.isSelected()){var n=this;for(var i in this.ports)!function(t){o=o.concat(r.map(n.ports[t].getLinks(),function(o){return o.getPointForPort(e.ports[t])}))}(i)}return o},NodeModel.prototype.deSerialize=function(e){t.prototype.deSerialize.call(this,e),this.x=e.x,this.y=e.y,this.extras=e.extras},NodeModel.prototype.serialize=function(){return r.merge(t.prototype.serialize.call(this),{x:this.x,y:this.y,extras:this.extras,ports:r.map(this.ports,function(t){return t.serialize()})})},NodeModel.prototype.doClone=function(t,e){void 0===t&&(t={}),e.ports={},r.values(this.ports).forEach(function(o){e.addPort(o.clone(t))})},NodeModel.prototype.remove=function(){t.prototype.remove.call(this);for(var e in this.ports)r.forEach(this.ports[e].getLinks(),function(t){t.remove()})},NodeModel.prototype.getPortFromID=function(t){for(var e in this.ports)if(this.ports[e].id===t)return this.ports[e];return null},NodeModel.prototype.getPort=function(t){return this.ports[t]},NodeModel.prototype.getPorts=function(){return this.ports},NodeModel.prototype.removePort=function(t){this.ports[t.name]&&(this.ports[t.name].setParentNode(null),delete this.ports[t.name])},NodeModel.prototype.addPort=function(t){return t.setParentNode(this),this.ports[t.name]=t,t},NodeModel}(i.BaseModel);e.NodeModel=s},function(t,e,o){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=o(9),r=o(0),s=function(){function BaseEntity(t){this.listeners={},this.id=t||i.Toolkit.UID(),this.locked=!1}return BaseEntity.prototype.getID=function(){return this.id},BaseEntity.prototype.doClone=function(t,e){void 0===t&&(t={})},BaseEntity.prototype.clone=function(t){if(void 0===t&&(t={}),t[this.id])return t[this.id];var e=r.clone(this);return e.id=i.Toolkit.UID(),e.clearListeners(),t[this.id]=e,this.doClone(t,e),e},BaseEntity.prototype.clearListeners=function(){this.listeners={}},BaseEntity.prototype.deSerialize=function(t){this.id=t.id},BaseEntity.prototype.serialize=function(){return{id:this.id}},BaseEntity.prototype.iterateListeners=function(t){var e={id:i.Toolkit.UID(),firing:!0,entity:this,stopPropagation:function(){e.firing=!1}};for(var o in this.listeners){if(!e.firing)return;t(this.listeners[o],e)}},BaseEntity.prototype.removeListener=function(t){return!!this.listeners[t]&&(delete this.listeners[t],!0)},BaseEntity.prototype.addListener=function(t){var e=i.Toolkit.UID();return this.listeners[e]=t,e},BaseEntity.prototype.isLocked=function(){return this.locked},BaseEntity.prototype.setLocked=function(t){void 0===t&&(t=!0),this.locked=t,this.iterateListeners(function(e,o){e.lockChanged&&e.lockChanged(n({},o,{locked:t}))})},BaseEntity}();e.BaseEntity=s},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=o(3),s=o(2),a=o(0),c=function(t){function LinkModel(e,o){void 0===e&&(e="default");var n=t.call(this,e,o)||this;return n.points=[new s.PointModel(n,{x:0,y:0}),new s.PointModel(n,{x:0,y:0})],n.extras={},n.sourcePort=null,n.targetPort=null,n.label=null,n}return n(LinkModel,t),LinkModel.prototype.deSerialize=function(e){var o=this;t.prototype.deSerialize.call(this,e),this.extras=e.extras,this.points=a.map(e.points,function(t){var e=new s.PointModel(o,{x:t.x,y:t.y});return e.deSerialize(t),e}),this.label=e.label||null},LinkModel.prototype.serialize=function(){return a.merge(t.prototype.serialize.call(this),{source:this.sourcePort?this.sourcePort.getParent().id:null,sourcePort:this.sourcePort?this.sourcePort.id:null,target:this.targetPort?this.targetPort.getParent().id:null,targetPort:this.targetPort?this.targetPort.id:null,points:a.map(this.points,function(t){return t.serialize()}),extras:this.extras,label:this.label||void 0})},LinkModel.prototype.doClone=function(t,e){void 0===t&&(t={}),e.setPoints(a.map(this.getPoints(),function(e){return e.clone(t)})),this.sourcePort&&e.setSourcePort(this.sourcePort.clone(t)),this.targetPort&&e.setTargetPort(this.targetPort.clone(t))},LinkModel.prototype.remove=function(){this.sourcePort&&this.sourcePort.removeLink(this),this.targetPort&&this.targetPort.removeLink(this),t.prototype.remove.call(this)},LinkModel.prototype.isLastPoint=function(t){return this.getPointIndex(t)===this.points.length-1},LinkModel.prototype.getPointIndex=function(t){return this.points.indexOf(t)},LinkModel.prototype.getPointModel=function(t){for(var e=0;e<this.points.length;e++)if(this.points[e].id===t)return this.points[e];return null},LinkModel.prototype.getPortForPoint=function(t){return null!==this.sourcePort&&this.getFirstPoint().getID()===t.getID()?this.sourcePort:null!==this.targetPort&&this.getLastPoint().getID()===t.getID()?this.targetPort:null},LinkModel.prototype.getPointForPort=function(t){return null!==this.sourcePort&&this.sourcePort.getID()===t.getID()?this.getFirstPoint():null!==this.targetPort&&this.targetPort.getID()===t.getID()?this.getLastPoint():null},LinkModel.prototype.getFirstPoint=function(){return this.points[0]},LinkModel.prototype.getLastPoint=function(){return this.points[this.points.length-1]},LinkModel.prototype.setSourcePort=function(t){t.addLink(this),this.sourcePort=t,this.iterateListeners(function(e,o){e.sourcePortChanged&&e.sourcePortChanged(i({},o,{port:t}))})},LinkModel.prototype.getSourcePort=function(){return this.sourcePort},LinkModel.prototype.getTargetPort=function(){return this.targetPort},LinkModel.prototype.setTargetPort=function(t){t.addLink(this),this.targetPort=t,this.iterateListeners(function(e,o){e.targetPortChanged&&e.targetPortChanged(i({},o,{port:t}))})},LinkModel.prototype.getLabel=function(){return this.label},LinkModel.prototype.setLabel=function(t){this.label=t},LinkModel.prototype.getPoints=function(){return this.points},LinkModel.prototype.setPoints=function(t){var e=this;a.forEach(t,function(t){t.link=e}),this.points=t},LinkModel.prototype.removePoint=function(t){this.points.splice(this.getPointIndex(t),1)},LinkModel.prototype.removePointsBefore=function(t){this.points.splice(0,this.getPointIndex(t))},LinkModel.prototype.removePointsAfter=function(t){this.points.splice(this.getPointIndex(t)+1)},LinkModel.prototype.addPoint=function(t,e){void 0===e&&(e=1),t.link=this,this.points.splice(e,0,t)},LinkModel}(r.BaseModel);e.LinkModel=c},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function AbstractFactory(t){this.type=t}return AbstractFactory.prototype.getType=function(){return this.type},AbstractFactory}();e.AbstractFactory=i;var r=function(t){function NodeFactory(){return null!==t&&t.apply(this,arguments)||this}return n(NodeFactory,t),NodeFactory}(i);e.NodeFactory=r;var s=function(t){function LinkFactory(){return null!==t&&t.apply(this,arguments)||this}return n(LinkFactory,t),LinkFactory}(i);e.LinkFactory=s;var a=function(t){function PortFactory(){return null!==t&&t.apply(this,arguments)||this}return n(PortFactory,t),PortFactory}(i);e.PortFactory=a;var c=function(t){function SimplePortFactory(e,o){var n=t.call(this,e)||this;return n.cb=o,n}return n(SimplePortFactory,t),SimplePortFactory.prototype.getNewInstance=function(t){return this.cb(t)},SimplePortFactory}(a);e.SimplePortFactory=c},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(3),r=o(6),s=o(0),a=function(t){function PortModel(e,o,n){var i=t.call(this,o,n)||this;return i.name=e,i.links={},i.parentNode=null,i}return n(PortModel,t),PortModel.prototype.deSerialize=function(e){t.prototype.deSerialize.call(this,e),this.name=e.name},PortModel.prototype.serialize=function(){return s.merge(t.prototype.serialize.call(this),{name:this.name,parentNode:this.parentNode.id,links:s.map(this.links,function(t){return t.id})})},PortModel.prototype.doClone=function(t,e){void 0===t&&(t={}),e.links={},e.parentNode=this.parentNode.clone(t)},PortModel.prototype.getName=function(){return this.name},PortModel.prototype.getParent=function(){return this.parentNode},PortModel.prototype.setParentNode=function(t){this.parentNode=t},PortModel.prototype.removeLink=function(t){delete this.links[t.getID()]},PortModel.prototype.addLink=function(t){this.links[t.getID()]=t},PortModel.prototype.getLinks=function(){return this.links},PortModel.prototype.createLinkModel=function(){var t=new r.LinkModel;return t.setSourcePort(this),t},PortModel.prototype.isLocked=function(){return t.prototype.isLocked.call(this)||this.getParent().isLocked()},PortModel}(i.BaseModel);e.PortModel=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(24),i=function(){function Toolkit(){}return Toolkit.UID=function(){return Toolkit.TESTING_MODE?"test-uid-"+ ++Toolkit.TESTING_MODE_ID:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},Toolkit.closest=function(t,e){return document.body.closest?t.closest(e):n(t,e)},Toolkit.TESTING_MODE=!1,Toolkit.TESTING_MODE_ID=1,Toolkit}();e.Toolkit=i},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=o(5),s=o(0),a=o(6),c=o(4),l=o(8),p=o(2),d=function(t){function DiagramModel(){var e=t.call(this)||this;return e.links={},e.nodes={},e.offsetX=0,e.offsetY=0,e.zoom=100,e.rendered=!1,e.gridSize=0,e}return n(DiagramModel,t),DiagramModel.prototype.setGridSize=function(t){void 0===t&&(t=0),this.gridSize=t,this.iterateListeners(function(e,o){e.gridUpdated&&e.gridUpdated(i({},o,{size:t}))})},DiagramModel.prototype.getGridPosition=function(t){return 0===this.gridSize?t:this.gridSize*Math.floor((t+this.gridSize/2)/this.gridSize)},DiagramModel.prototype.deSerializeDiagram=function(t,e){var o=this;this.deSerialize(t),this.offsetX=t.offsetX,this.offsetY=t.offsetY,this.zoom=t.zoom,this.gridSize=t.gridSize,s.forEach(t.nodes,function(t){var n=e.getNodeFactory(t.type).getNewInstance(t);n.deSerialize(t),s.forEach(t.ports,function(t){var o=e.getPortFactory(t.type).getNewInstance();o.deSerialize(t),n.addPort(o)}),o.addNode(n)}),s.forEach(t.links,function(t){var n=e.getLinkFactory(t.type).getNewInstance();n.deSerialize(t),t.target&&n.setTargetPort(o.getNode(t.target).getPortFromID(t.targetPort)),t.source&&n.setSourcePort(o.getNode(t.source).getPortFromID(t.sourcePort)),o.addLink(n)})},DiagramModel.prototype.serializeDiagram=function(){return s.merge(this.serialize(),{offsetX:this.offsetX,offsetY:this.offsetY,zoom:this.zoom,gridSize:this.gridSize,links:s.map(this.links,function(t){return t.serialize()}),nodes:s.map(this.nodes,function(t){return t.serialize()})})},DiagramModel.prototype.clearSelection=function(t){void 0===t&&(t=null),s.forEach(this.getSelectedItems(),function(e){t&&t.getID()===e.getID()||e.setSelected(!1)})},DiagramModel.prototype.getSelectedItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Array.isArray(t)||(t=[t]);var o=[];return o=o.concat(s.flatMap(this.nodes,function(t){return t.getSelectedEntities()})),o=o.concat(s.flatMap(this.links,function(t){return t.getSelectedEntities()})),o=o.concat(s.flatMap(this.links,function(t){return s.flatMap(t.points,function(t){return t.getSelectedEntities()})})),o=s.uniq(o),t.length>0&&(o=s.filter(s.uniq(o),function(e){return!!(s.includes(t,"node")&&e instanceof c.NodeModel)||(!!(s.includes(t,"link")&&e instanceof a.LinkModel)||(!!(s.includes(t,"port")&&e instanceof l.PortModel)||!!(s.includes(t,"point")&&e instanceof p.PointModel)))})),o},DiagramModel.prototype.setZoomLevel=function(t){this.zoom=t,this.iterateListeners(function(e,o){e.zoomUpdated&&e.zoomUpdated(i({},o,{zoom:t}))})},DiagramModel.prototype.setOffset=function(t,e){this.offsetX=t,this.offsetY=e,this.iterateListeners(function(o,n){o.offsetUpdated&&o.offsetUpdated(i({},n,{offsetX:t,offsetY:e}))})},DiagramModel.prototype.setOffsetX=function(t){var e=this;this.offsetX=t,this.iterateListeners(function(o,n){o.offsetUpdated&&o.offsetUpdated(i({},n,{offsetX:t,offsetY:e.offsetY}))})},DiagramModel.prototype.setOffsetY=function(t){var e=this;this.offsetY=t,this.iterateListeners(function(t,o){t.offsetUpdated&&t.offsetUpdated(i({},o,{offsetX:e.offsetX,offsetY:e.offsetY}))})},DiagramModel.prototype.getOffsetY=function(){return this.offsetY},DiagramModel.prototype.getOffsetX=function(){return this.offsetX},DiagramModel.prototype.getZoomLevel=function(){return this.zoom},DiagramModel.prototype.getNode=function(t){return t instanceof c.NodeModel?t:this.nodes[t]?this.nodes[t]:null},DiagramModel.prototype.getLink=function(t){return t instanceof a.LinkModel?t:this.links[t]?this.links[t]:null},DiagramModel.prototype.addLink=function(t){var e=this;return t.addListener({entityRemoved:function(){e.removeLink(t)}}),this.links[t.getID()]=t,this.iterateListeners(function(e,o){e.linksUpdated&&e.linksUpdated(i({},o,{link:t,isCreated:!0}))}),t},DiagramModel.prototype.addNode=function(t){var e=this;return t.addListener({entityRemoved:function(){e.removeNode(t)}}),this.nodes[t.getID()]=t,this.iterateListeners(function(e,o){e.nodesUpdated&&e.nodesUpdated(i({},o,{node:t,isCreated:!0}))}),t},DiagramModel.prototype.removeLink=function(t){t=this.getLink(t),delete this.links[t.getID()],this.iterateListeners(function(e,o){e.linksUpdated&&e.linksUpdated(i({},o,{link:t,isCreated:!1}))})},DiagramModel.prototype.removeNode=function(t){t=this.getNode(t),delete this.nodes[t.getID()],this.iterateListeners(function(e,o){e.nodesUpdated&&e.nodesUpdated(i({},o,{node:t,isCreated:!1}))})},DiagramModel.prototype.getLinks=function(){return this.links},DiagramModel.prototype.getNodes=function(){return this.nodes},DiagramModel}(r.BaseEntity);e.DiagramModel=d},function(t,e,o){"use strict";function __export(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),__export(o(23)),__export(o(12)),__export(o(26)),__export(o(14)),__export(o(13)),__export(o(17)),__export(o(15)),__export(o(7)),__export(o(9)),__export(o(27)),__export(o(10)),__export(o(5)),__export(o(18)),__export(o(3)),__export(o(10)),__export(o(6)),__export(o(4)),__export(o(2)),__export(o(8)),__export(o(29)),__export(o(19)),__export(o(20)),__export(o(21)),__export(o(22)),__export(o(16))},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=o(1),s=o(2),a=function(t){function DefaultLinkWidget(e){var o=t.call(this,e)||this;return o.addPointToLink=function(t,e){if(!t.shiftKey&&!o.props.diagramEngine.isModelLocked(o.props.link)&&o.props.link.points.length-1<=o.props.diagramEngine.getMaxNumberPointsPerLink()){var n=new s.PointModel(o.props.link,o.props.diagramEngine.getRelativeMousePoint(t));n.setSelected(!0),o.forceUpdate(),o.props.link.addPoint(n,e),o.props.pointAdded(n,t)}},o.findPathAndRelativePositionToRenderLabel=function(){for(var t=o.refPaths.map(function(t){return t.getTotalLength()}),e=t.reduce(function(t,e){return t+e},0)/2,n=0;n<o.refPaths.length;){if(e-t[n]<0)return{path:o.refPaths[n],position:e};e-=t[n],n++}},o.calculateLabelPosition=function(){if(o.refLabel){var t=o.findPathAndRelativePositionToRenderLabel(),e=t.path,n=t.position,i={width:o.refLabel.offsetWidth,height:o.refLabel.offsetHeight},r=e.getPointAtLength(n),s={x:r.x-i.width/2,y:r.y-i.height/2};o.refLabel.setAttribute("style","transform: translate("+s.x+"px, "+s.y+"px);")}},o.state={selected:!1},o}return n(DefaultLinkWidget,t),DefaultLinkWidget.prototype.generatePoint=function(t){var e=this,o=this.props.link.points[t].x,n=this.props.link.points[t].y;return r.createElement("g",{key:"point-"+this.props.link.points[t].id},r.createElement("circle",{cx:o,cy:n,r:5,className:"point pointui"+(this.props.link.points[t].isSelected()?" selected":"")}),r.createElement("circle",{onMouseLeave:function(){e.setState({selected:!1})},onMouseEnter:function(){e.setState({selected:!0})},"data-id":this.props.link.points[t].id,"data-linkid":this.props.link.id,cx:o,cy:n,r:15,opacity:0,className:"point"}))},DefaultLinkWidget.prototype.generateLink=function(t,e){var o=this,n=this.props,s=r.createElement("path",i({className:this.state.selected||this.props.link.isSelected()?"selected":"",strokeWidth:n.width,stroke:n.color,ref:function(t){return t&&o.refPaths.push(t)}},t)),a=r.createElement("path",i({strokeLinecap:"round",onMouseLeave:function(){o.setState({selected:!1})},onMouseEnter:function(){o.setState({selected:!0})},"data-linkid":this.props.link.getID(),stroke:n.color,strokeOpacity:this.state.selected?.1:0,strokeWidth:20,onContextMenu:function(){o.props.diagramEngine.isModelLocked(o.props.link)||(event.preventDefault(),o.props.link.remove())}},t));return r.createElement("g",{key:"link-"+e},s,a)},DefaultLinkWidget.prototype.generateLabel=function(){var t=this,e=this.props.diagramEngine.canvas;return r.createElement("foreignObject",{className:"link-label",width:e.offsetWidth,height:e.offsetHeight},r.createElement("div",{ref:function(e){return t.refLabel=e}},this.props.link.label))},DefaultLinkWidget.prototype.componentDidUpdate=function(){window.requestAnimationFrame(this.calculateLabelPosition)},DefaultLinkWidget.prototype.componentDidMount=function(){window.requestAnimationFrame(this.calculateLabelPosition)},DefaultLinkWidget.prototype.generateLinePath=function(t,e){return"M"+t.x+","+t.y+" L "+e.x+","+e.y},DefaultLinkWidget.prototype.generateCurvePath=function(t,e,o,n){return void 0===o&&(o=0),void 0===n&&(n=0),"M"+t.x+","+t.y+" C "+(t.x+o)+","+t.y+" "+(e.x+n)+","+e.y+" "+e.x+","+e.y},DefaultLinkWidget.prototype.render=function(){var t=this,e=this.props.link.points,o=[];this.props.diagramEngine.getDiagramModel();if(2===e.length){var n=50;Math.abs(e[0].x-e[1].x)<50&&(n=5);var i=e[0],s=e[1];i.x>s.x&&(i=e[1],s=e[0]),o.push(this.generateLink({onMouseDown:function(e){t.addPointToLink(e,1)},d:this.generateCurvePath(i,s,n,-n)},"0")),null===this.props.link.targetPort&&o.push(this.generatePoint(1))}else{var a=[];if(this.props.smooth){a.push(this.generateCurvePath(e[0],e[1],50,0));for(var c=1;c<e.length-2;c++)a.push(this.generateLinePath(e[c],e[c+1]));a.push(this.generateCurvePath(e[c],e[c+1],0,-50))}else for(var a=[],c=0;c<e.length-1;c++)a.push(this.generateLinePath(e[c],e[c+1]));o=a.map(function(e,o){return t.generateLink({"data-linkid":t.props.link.id,"data-point":o,onMouseDown:function(e){t.addPointToLink(e,o+1)},d:e},o)});for(var c=1;c<e.length-1;c++)o.push(this.generatePoint(c));null===this.props.link.targetPort&&o.push(this.generatePoint(e.length-1))}return this.refLabel=null,this.refPaths=[],r.createElement("g",null,o,this.props.link.label&&this.generateLabel())},DefaultLinkWidget.defaultProps={color:"black",width:3,link:null,engine:null,smooth:!1,diagramEngine:null},DefaultLinkWidget}(r.Component);e.DefaultLinkWidget=a},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=o(4),s=function(t){function DefaultNodeModel(e,o){void 0===e&&(e="Untitled"),void 0===o&&(o="rgb(0,192,255)");var n=t.call(this,"default")||this;return n.name=e,n.color=o,n}return n(DefaultNodeModel,t),DefaultNodeModel.prototype.deSerialize=function(e){t.prototype.deSerialize.call(this,e),this.name=e.name,this.color=e.color},DefaultNodeModel.prototype.serialize=function(){return i.merge(t.prototype.serialize.call(this),{name:this.name,color:this.color})},DefaultNodeModel.prototype.getInPorts=function(){return i.filter(this.ports,function(t){return t.in})},DefaultNodeModel.prototype.getOutPorts=function(){return i.filter(this.ports,function(t){return!t.in})},DefaultNodeModel}(r.NodeModel);e.DefaultNodeModel=s},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=o(0),s=o(15),a=function(t){function DefaultNodeWidget(e){var o=t.call(this,e)||this;return o.state={},o}return n(DefaultNodeWidget,t),DefaultNodeWidget.prototype.generatePort=function(t){return i.createElement(s.DefaultPortLabel,{model:t,key:t.id})},DefaultNodeWidget.prototype.render=function(){return i.createElement("div",{className:"basic-node",style:{background:this.props.node.color}},i.createElement("div",{className:"title"},i.createElement("div",{className:"name"},this.props.node.name)),i.createElement("div",{className:"ports"},i.createElement("div",{className:"in"},r.map(this.props.node.getInPorts(),this.generatePort.bind(this))),i.createElement("div",{className:"out"},r.map(this.props.node.getOutPorts(),this.generatePort.bind(this)))))},DefaultNodeWidget}(i.Component);e.DefaultNodeWidget=a},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=o(16),s=function(t){function DefaultPortLabel(){return null!==t&&t.apply(this,arguments)||this}return n(DefaultPortLabel,t),DefaultPortLabel.prototype.render=function(){var t=i.createElement(r.PortWidget,{node:this.props.model.getParent(),name:this.props.model.name}),e=i.createElement("div",{className:"name"},this.props.model.label);return i.createElement("div",{className:(this.props.model.in?"in":"out")+"-port"},this.props.model.in?t:e,this.props.model.in?e:t)},DefaultPortLabel.defaultProps={in:!0,label:"port"},DefaultPortLabel}(i.Component);e.DefaultPortLabel=s},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=function(t){function PortWidget(e){var o=t.call(this,e)||this;return o.state={selected:!1},o}return n(PortWidget,t),PortWidget.prototype.render=function(){var t=this;return i.createElement("div",{onMouseEnter:function(){t.setState({selected:!0})},onMouseLeave:function(){t.setState({selected:!1})},className:"port"+(this.state.selected?" selected":""),"data-name":this.props.name,"data-nodeid":this.props.node.getID()})},PortWidget}(i.Component);e.PortWidget=r},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=o(8),s=function(t){function DefaultPortModel(e,o,n,i){void 0===n&&(n=null);var r=t.call(this,o,"default",i)||this;return r.in=e,r.label=n||o,r}return n(DefaultPortModel,t),DefaultPortModel.prototype.deSerialize=function(e){t.prototype.deSerialize.call(this,e),this.in=e.in,this.label=e.label},DefaultPortModel.prototype.serialize=function(){return i.merge(t.prototype.serialize.call(this),{in:this.in,label:this.label})},DefaultPortModel}(r.PortModel);e.DefaultPortModel=s},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function BaseAction(t,e){this.mouseX=t,this.mouseY=e,this.ms=(new Date).getTime()}return BaseAction}();e.BaseAction=i;var r=function(t){function SelectingAction(e,o){var n=t.call(this,e,o)||this;return n.mouseX2=e,n.mouseY2=o,n}return n(SelectingAction,t),SelectingAction.prototype.getBoxDimensions=function(){return{left:this.mouseX2>this.mouseX?this.mouseX:this.mouseX2,top:this.mouseY2>this.mouseY?this.mouseY:this.mouseY2,width:Math.abs(this.mouseX2-this.mouseX),height:Math.abs(this.mouseY2-this.mouseY),right:this.mouseX2<this.mouseX?this.mouseX:this.mouseX2,bottom:this.mouseY2<this.mouseY?this.mouseY:this.mouseY2}},SelectingAction.prototype.containsElement=function(t,e,o){var n=o.getZoomLevel()/100,i=this.getBoxDimensions();return t*n+o.getOffsetX()>i.left&&t*n+o.getOffsetX()<i.right&&e*n+o.getOffsetY()>i.top&&e*n+o.getOffsetY()<i.bottom},SelectingAction}(i);e.SelectingAction=r;var s=function(t){function MoveCanvasAction(e,o,n){var i=t.call(this,e,o)||this;return i.initialOffsetX=n.getOffsetX(),i.initialOffsetY=n.getOffsetY(),i}return n(MoveCanvasAction,t),MoveCanvasAction}(i);e.MoveCanvasAction=s;var a=function(t){function MoveItemsAction(e,o,n){var i=t.call(this,e,o)||this;i.moved=!1,n.enableRepaintEntities(n.getDiagramModel().getSelectedItems());var r=n.getDiagramModel().getSelectedItems();return r=r.filter(function(t){return!n.isModelLocked(t)}),i.selectionModels=r.map(function(t){return{model:t,initialX:t.x,initialY:t.y}}),i}return n(MoveItemsAction,t),MoveItemsAction}(i);e.MoveItemsAction=a},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=o(20),s=o(0),a=function(t){function LinkLayerWidget(e){var o=t.call(this,e)||this;return o.state={},o}return n(LinkLayerWidget,t),LinkLayerWidget.prototype.render=function(){var t=this,e=this.props.diagramEngine.getDiagramModel();return i.createElement("svg",{style:{transform:"translate("+e.getOffsetX()+"px,"+e.getOffsetY()+"px) scale("+e.getZoomLevel()/100+")",width:"100%",height:"100%"}},this.props.diagramEngine.canvas&&s.map(e.getLinks(),function(e){if(t.props.diagramEngine.nodesRendered&&!t.props.diagramEngine.linksThatHaveInitiallyRendered[e.id]){if(null!==e.sourcePort)try{e.points[0].updateLocation(t.props.diagramEngine.getPortCenter(e.sourcePort)),t.props.diagramEngine.linksThatHaveInitiallyRendered[e.id]=!0}catch(t){}if(null!==e.targetPort)try{s.last(e.points).updateLocation(t.props.diagramEngine.getPortCenter(e.targetPort)),t.props.diagramEngine.linksThatHaveInitiallyRendered[e.id]=!0}catch(t){}}var o=t.props.diagramEngine.generateWidgetForLink(e);return o?i.createElement(r.LinkWidget,{key:e.getID(),link:e,diagramEngine:t.props.diagramEngine},i.cloneElement(o,{pointAdded:t.props.pointAdded})):(console.log("no link generated for type: "+e.getType()),null)}))},LinkLayerWidget}(i.Component);e.LinkLayerWidget=a},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=function(t){function LinkWidget(e){var o=t.call(this,e)||this;return o.state={},o}return n(LinkWidget,t),LinkWidget.prototype.shouldComponentUpdate=function(){return this.props.diagramEngine.canEntityRepaint(this.props.link)},LinkWidget.prototype.render=function(){return this.props.children},LinkWidget}(i.Component);e.LinkWidget=r},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=o(0),s=o(22),a=function(t){function NodeLayerWidget(e){var o=t.call(this,e)||this;return o.state={},o}return n(NodeLayerWidget,t),NodeLayerWidget.prototype.componentDidUpdate=function(){this.props.diagramEngine.nodesRendered=!0},NodeLayerWidget.prototype.render=function(){var t=this,e=this.props.diagramEngine.getDiagramModel();return i.createElement("div",{className:"node-view",style:{transform:"translate("+e.getOffsetX()+"px,"+e.getOffsetY()+"px) scale("+e.getZoomLevel()/100+")",width:"100%",height:"100%"}},r.map(e.getNodes(),function(e){return i.createElement(s.NodeWidget,{diagramEngine:t.props.diagramEngine,key:e.id,node:e},t.props.diagramEngine.generateWidgetForNode(e))}))},NodeLayerWidget}(i.Component);e.NodeLayerWidget=a},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=function(t){function NodeWidget(e){var o=t.call(this,e)||this;return o.state={},o}return n(NodeWidget,t),NodeWidget.prototype.shouldComponentUpdate=function(){return this.props.diagramEngine.canEntityRepaint(this.props.node)},NodeWidget.prototype.render=function(){return i.createElement("div",{"data-nodeid":this.props.node.id,className:"node"+(this.props.node.isSelected()?" selected":""),style:{top:this.props.node.y,left:this.props.node.x}},this.props.children)},NodeWidget}(i.Component);e.NodeWidget=r},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(1),r=o(12),s=o(6),a=o(7),c=function(t){function DefaultLinkFactory(){return t.call(this,"default")||this}return n(DefaultLinkFactory,t),DefaultLinkFactory.prototype.generateReactWidget=function(t,e){return i.createElement(r.DefaultLinkWidget,{link:e,diagramEngine:t})},DefaultLinkFactory.prototype.getNewInstance=function(t){return new s.LinkModel},DefaultLinkFactory}(a.LinkFactory);e.DefaultLinkFactory=c},function(t,e,o){var n=o(25);t.exports=function(t,e,o){for(var i=o?t:t.parentNode;i&&i!==document;){if(n(i,e))return i;i=i.parentNode}}},function(t,e){function match(t,e){if(n)return n.call(t,e);for(var o=t.parentNode.querySelectorAll(e),i=0;i<o.length;++i)if(o[i]==t)return!0;return!1}var o=Element.prototype,n=o.matchesSelector||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector;t.exports=match},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(13),r=o(1),s=o(14),a=o(7),c=function(t){function DefaultNodeFactory(){return t.call(this,"default")||this}return n(DefaultNodeFactory,t),DefaultNodeFactory.prototype.generateReactWidget=function(t,e){return r.createElement(s.DefaultNodeWidget,{node:e,diagramEngine:t})},DefaultNodeFactory.prototype.getNewInstance=function(t){return new i.DefaultNodeModel},DefaultNodeFactory}(a.NodeFactory);e.DefaultNodeFactory=c},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(5),r=o(10),s=o(0),a=o(4),c=o(2),l=o(11),p=o(28),d=function(t){function DiagramEngine(){var e=t.call(this)||this;return e.diagramModel=new r.DiagramModel,e.nodeFactories={},e.linkFactories={},e.portFactories={},e.canvas=null,e.paintableWidgets=null,e.linksThatHaveInitiallyRendered={},e}return n(DiagramEngine,t),DiagramEngine.prototype.installDefaultFactories=function(){this.registerNodeFactory(new l.DefaultNodeFactory),this.registerLinkFactory(new l.DefaultLinkFactory),this.registerPortFactory(new p.DefaultPortFactory)},DiagramEngine.prototype.repaintCanvas=function(){this.iterateListeners(function(t){t.repaintCanvas&&t.repaintCanvas()})},DiagramEngine.prototype.clearRepaintEntities=function(){this.paintableWidgets=null},DiagramEngine.prototype.enableRepaintEntities=function(t){var e=this;this.paintableWidgets={},t.forEach(function(t){t instanceof a.NodeModel&&s.forEach(t.getPorts(),function(t){s.forEach(t.getLinks(),function(t){e.paintableWidgets[t.getID()]=!0})}),t instanceof c.PointModel&&(e.paintableWidgets[t.getLink().getID()]=!0),e.paintableWidgets[t.getID()]=!0})},DiagramEngine.prototype.isModelLocked=function(t){return!!this.diagramModel.isLocked()||t.isLocked()},DiagramEngine.prototype.recalculatePortsVisually=function(){this.nodesRendered=!1,this.linksThatHaveInitiallyRendered={}},DiagramEngine.prototype.canEntityRepaint=function(t){return null===this.paintableWidgets||void 0!==this.paintableWidgets[t.getID()]},DiagramEngine.prototype.setCanvas=function(t){this.canvas=t},DiagramEngine.prototype.setDiagramModel=function(t){this.diagramModel=t,this.recalculatePortsVisually()},DiagramEngine.prototype.getDiagramModel=function(){return this.diagramModel},DiagramEngine.prototype.getNodeFactories=function(){return this.nodeFactories},DiagramEngine.prototype.getLinkFactories=function(){return this.linkFactories},DiagramEngine.prototype.registerPortFactory=function(t){this.portFactories[t.getType()]=t,this.iterateListeners(function(t){t.portFactoriesUpdated&&t.portFactoriesUpdated()})},DiagramEngine.prototype.registerNodeFactory=function(t){this.nodeFactories[t.getType()]=t,this.iterateListeners(function(t){t.nodeFactoriesUpdated&&t.nodeFactoriesUpdated()})},DiagramEngine.prototype.registerLinkFactory=function(t){this.linkFactories[t.getType()]=t,this.iterateListeners(function(t){t.linkFactoriesUpdated&&t.linkFactoriesUpdated()})},DiagramEngine.prototype.getPortFactory=function(t){return this.portFactories[t]?this.portFactories[t]:(console.log("cannot find factory for port of type: ["+t+"]"),null)},DiagramEngine.prototype.getNodeFactory=function(t){return this.nodeFactories[t]?this.nodeFactories[t]:(console.log("cannot find factory for node of type: ["+t+"]"),null)},DiagramEngine.prototype.getLinkFactory=function(t){return this.linkFactories[t]?this.linkFactories[t]:(console.log("cannot find factory for link of type: ["+t+"]"),null)},DiagramEngine.prototype.getFactoryForNode=function(t){return this.getNodeFactory(t.getType())},DiagramEngine.prototype.getFactoryForLink=function(t){return this.getLinkFactory(t.getType())},DiagramEngine.prototype.generateWidgetForLink=function(t){var e=this.getFactoryForLink(t);if(!e)throw new Error("Cannot find link factory for link: "+t.getType());return e.generateReactWidget(this,t)},DiagramEngine.prototype.generateWidgetForNode=function(t){var e=this.getFactoryForNode(t);if(!e)throw new Error("Cannot find widget factory for node: "+t.getType());return e.generateReactWidget(this,t)},DiagramEngine.prototype.getRelativeMousePoint=function(t){var e=this.getRelativePoint(t.clientX,t.clientY);return{x:(e.x-this.diagramModel.getOffsetX())/(this.diagramModel.getZoomLevel()/100),y:(e.y-this.diagramModel.getOffsetY())/(this.diagramModel.getZoomLevel()/100)}},DiagramEngine.prototype.getRelativePoint=function(t,e){var o=this.canvas.getBoundingClientRect();return{x:t-o.left,y:e-o.top}},DiagramEngine.prototype.getNodePortElement=function(t){var e=this.canvas.querySelector('.port[data-name="'+t.getName()+'"][data-nodeid="'+t.getParent().getID()+'"]');if(null===e)throw new Error("Cannot find Node Port element with nodeID: ["+t.getParent().getID()+"] and name: ["+t.getName()+"]");return e},DiagramEngine.prototype.getPortCenter=function(t){var e=this.getNodePortElement(t),o=e.getBoundingClientRect(),n=this.getRelativePoint(o.left,o.top);return{x:e.offsetWidth/2+(n.x-this.diagramModel.getOffsetX())/(this.diagramModel.getZoomLevel()/100),y:e.offsetHeight/2+(n.y-this.diagramModel.getOffsetY())/(this.diagramModel.getZoomLevel()/100)}},DiagramEngine.prototype.getMaxNumberPointsPerLink=function(){return this.maxNumberPointsPerLink},DiagramEngine.prototype.setMaxNumberPointsPerLink=function(t){this.maxNumberPointsPerLink=t},DiagramEngine.prototype.zoomToFit=function(){var t=this.canvas.clientWidth/this.canvas.scrollWidth,e=this.canvas.clientHeight/this.canvas.scrollHeight,o=t<e?t:e;this.diagramModel.setZoomLevel(this.diagramModel.getZoomLevel()*o),this.diagramModel.setOffset(0,0),this.repaintCanvas()},DiagramEngine}(i.BaseEntity);e.DiagramEngine=d},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=o(17),r=o(7),s=function(t){function DefaultPortFactory(){return t.call(this,"default")||this}return n(DefaultPortFactory,t),DefaultPortFactory.prototype.getNewInstance=function(t){return new i.DefaultPortModel(!0,"unknown")},DefaultPortFactory}(r.PortFactory);e.DefaultPortFactory=s},function(t,e,o){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function __(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++){e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=o(1),s=o(0),a=o(19),c=o(21),l=o(9),p=o(18),d=o(4),u=o(2),f=o(8),h=function(t){function DiagramWidget(e){var o=t.call(this,e)||this;return o.onMouseMove=o.onMouseMove.bind(o),o.onMouseUp=o.onMouseUp.bind(o),o.state={action:null,wasMoved:!1,renderedNodes:!1,windowListener:null,diagramEngineListener:null,document:null},o}return n(DiagramWidget,t),DiagramWidget.prototype.componentWillUnmount=function(){this.props.diagramEngine.removeListener(this.state.diagramEngineListener),this.props.diagramEngine.setCanvas(null),window.removeEventListener("keyup",this.onKeyUpPointer),window.removeEventListener("mouseUp",this.onMouseUp),window.removeEventListener("mouseMove",this.onMouseMove)},DiagramWidget.prototype.componentWillReceiveProps=function(t){var e=this;if(this.props.diagramEngine!==t.diagramEngine){this.props.diagramEngine.removeListener(this.state.diagramEngineListener);var o=t.diagramEngine.addListener({repaintCanvas:function(){return e.forceUpdate()}});this.setState({diagramEngineListener:o})}},DiagramWidget.prototype.componentWillUpdate=function(t){this.props.diagramEngine.diagramModel.id!==t.diagramEngine.diagramModel.id&&(this.setState({renderedNodes:!1}),t.diagramEngine.diagramModel.rendered=!0),t.diagramEngine.diagramModel.rendered||(this.setState({renderedNodes:!1}),t.diagramEngine.diagramModel.rendered=!0)},DiagramWidget.prototype.componentDidUpdate=function(){this.state.renderedNodes||this.setState({renderedNodes:!0})},DiagramWidget.prototype.componentDidMount=function(){var t=this;this.onKeyUpPointer=this.onKeyUp.bind(this),this.setState({document:document,renderedNodes:!0,diagramEngineListener:this.props.diagramEngine.addListener({repaintCanvas:function(){t.forceUpdate()}})}),window.addEventListener("keyup",this.onKeyUpPointer,!1),window.focus()},DiagramWidget.prototype.getMouseElement=function(t){var e=t.target,o=this.props.diagramEngine.diagramModel,n=l.Toolkit.closest(e,".port[data-name]");if(n){var i=l.Toolkit.closest(e,".node[data-nodeid]");return{model:o.getNode(i.getAttribute("data-nodeid")).getPort(n.getAttribute("data-name")),element:n}}return(n=l.Toolkit.closest(e,".point[data-id]"))?{model:o.getLink(n.getAttribute("data-linkid")).getPointModel(n.getAttribute("data-id")),element:n}:(n=l.Toolkit.closest(e,"[data-linkid]"))?{model:o.getLink(n.getAttribute("data-linkid")),element:n}:(n=l.Toolkit.closest(e,".node[data-nodeid]"),n?{model:o.getNode(n.getAttribute("data-nodeid")),element:n}:null)},DiagramWidget.prototype.fireAction=function(){this.state.action&&this.props.actionStillFiring&&this.props.actionStillFiring(this.state.action)},DiagramWidget.prototype.stopFiringAction=function(t){this.props.actionStoppedFiring&&!t&&this.props.actionStoppedFiring(this.state.action),this.setState({action:null})},DiagramWidget.prototype.startFiringAction=function(t){var e=!0;this.props.actionStartedFiring&&(e=this.props.actionStartedFiring(t)),e&&this.setState({action:t})},DiagramWidget.prototype.onMouseMove=function(t){var e=this,o=this.props.diagramEngine,n=o.getDiagramModel();if(this.state.action instanceof p.SelectingAction){var i=o.getRelativePoint(t.clientX,t.clientY);return s.forEach(n.getNodes(),function(t){e.state.action.containsElement(t.x,t.y,n)&&t.setSelected(!0)}),s.forEach(n.getLinks(),function(t){var o=!0;s.forEach(t.points,function(t){e.state.action.containsElement(t.x,t.y,n)?t.setSelected(!0):o=!1}),o&&t.setSelected(!0)}),this.state.action.mouseX2=i.x,this.state.action.mouseY2=i.y,this.fireAction(),void this.setState({action:this.state.action})}if(this.state.action instanceof p.MoveItemsAction){var r=t.clientX-this.state.action.mouseX,a=t.clientY-this.state.action.mouseY,c=n.getZoomLevel()/100;s.forEach(this.state.action.selectionModels,function(t){t.model instanceof d.NodeModel||t.model instanceof u.PointModel&&!t.model.isConnectedToPort()?(t.model.x=n.getGridPosition(t.initialX+r/c),t.model.y=n.getGridPosition(t.initialY+a/c)):t.model instanceof u.PointModel&&(t.model.x=t.initialX+n.getGridPosition(r/c),t.model.y=t.initialY+n.getGridPosition(a/c))}),this.fireAction(),this.state.wasMoved?this.forceUpdate():this.setState({wasMoved:!0})}else this.state.action instanceof p.MoveCanvasAction&&this.props.allowCanvasTranslation&&(n.setOffset(this.state.action.initialOffsetX+(t.clientX-this.state.action.mouseX),this.state.action.initialOffsetY+(t.clientY-this.state.action.mouseY)),this.fireAction(),this.forceUpdate())},DiagramWidget.prototype.onKeyUp=function(t){var e=this;-1!==this.props.deleteKeys.indexOf(t.keyCode)&&(s.forEach(this.props.diagramEngine.getDiagramModel().getSelectedItems(),function(t){e.props.diagramEngine.isModelLocked(t)||t.remove()}),this.forceUpdate())},DiagramWidget.prototype.onMouseUp=function(t){var e=this,o=this.props.diagramEngine;if(this.state.action instanceof p.MoveItemsAction){var n=this.getMouseElement(t),i=!1;s.forEach(this.state.action.selectionModels,function(t){if(t.model instanceof u.PointModel){if(n&&n.model instanceof f.PortModel&&!o.isModelLocked(n.model)){i=!0;var r=t.model.getLink();if(null!==r.getTargetPort())if(r.getTargetPort()!==n.model&&r.getSourcePort()!==n.model){var s=r.getTargetPort(),a=r.clone({});a.setSourcePort(n.model),a.setTargetPort(s),r.setTargetPort(n.model),s.removeLink(r),a.removePointsBefore(a.getPoints()[r.getPointIndex(t.model)]),r.removePointsAfter(t.model),o.getDiagramModel().addLink(a)}else r.getTargetPort()===n.model?r.removePointsAfter(t.model):r.getSourcePort()===n.model&&r.removePointsBefore(t.model);else r.setTargetPort(n.model);delete e.props.diagramEngine.linksThatHaveInitiallyRendered[r.getID()]}(!e.props.allowLooseLinks&&n.model instanceof d.NodeModel||!e.state.wasMoved)&&(i=!0)}}),i||this.props.allowLooseLinks||s.forEach(this.state.action.selectionModels,function(t){if(t.model instanceof u.PointModel){var e=t.model.getLink();e.isLastPoint(t.model)&&e.remove()}}),o.clearRepaintEntities(),this.stopFiringAction(!this.state.wasMoved)}else o.clearRepaintEntities(),this.stopFiringAction();this.state.document.removeEventListener("mousemove",this.onMouseMove),this.state.document.removeEventListener("mouseup",this.onMouseUp)},DiagramWidget.prototype.drawSelectionBox=function(){var t=this.state.action.getBoxDimensions();return r.createElement("div",{className:"selector",style:{top:t.top,left:t.left,width:t.width,height:t.height}})},DiagramWidget.prototype.render=function(){var t=this,e=this.props.diagramEngine;e.setMaxNumberPointsPerLink(this.props.maxNumberPointsPerLink);var o=e.getDiagramModel();return r.createElement("div",{ref:function(e){e&&t.props.diagramEngine.setCanvas(e)},className:"storm-diagrams-canvas",onWheel:function(n){if(t.props.allowCanvasZoom){n.preventDefault(),n.stopPropagation();var i=o.getZoomLevel()/100,r=t.props.inverseZoom?-n.deltaY:n.deltaY;n.ctrlKey&&r%1!=0?r/=3:r/=60,o.getZoomLevel()+r>10&&o.setZoomLevel(o.getZoomLevel()+r);var s=o.getZoomLevel()/100,a=n.currentTarget.getBoundingClientRect(),c=a.width,l=a.height,p=c*s-c*i,d=l*s-l*i,u=n.clientX-a.left,f=n.clientY-a.top,h=(u-o.getOffsetX())/i/c,g=(f-o.getOffsetY())/i/l;o.setOffset(o.getOffsetX()-p*h,o.getOffsetY()-d*g),e.enableRepaintEntities([]),t.forceUpdate()}},onMouseDown:function(n){t.setState(i({},t.state,{wasMoved:!1})),e.clearRepaintEntities();var r=t.getMouseElement(n);if(null===r)if(n.shiftKey){var s=e.getRelativePoint(n.clientX,n.clientY);t.startFiringAction(new p.SelectingAction(s.x,s.y))}else o.clearSelection(),t.startFiringAction(new p.MoveCanvasAction(n.clientX,n.clientY,o));else if(r.model instanceof f.PortModel)if(t.props.diagramEngine.isModelLocked(r.model))o.clearSelection();else{var s=e.getRelativeMousePoint(n),a=r.model,c=a.createLinkModel();c.getFirstPoint().updateLocation(s),c.getLastPoint().updateLocation(s),o.clearSelection(),c.getLastPoint().setSelected(!0),o.addLink(c),t.startFiringAction(new p.MoveItemsAction(n.clientX,n.clientY,e))}else n.shiftKey||r.model.isSelected()||o.clearSelection(),r.model.setSelected(!0),t.startFiringAction(new p.MoveItemsAction(n.clientX,n.clientY,e));t.state.document.addEventListener("mousemove",t.onMouseMove),t.state.document.addEventListener("mouseup",t.onMouseUp)}},this.state.renderedNodes&&r.createElement(a.LinkLayerWidget,{diagramEngine:e,pointAdded:function(n,i){t.state.document.addEventListener("mousemove",t.onMouseMove),t.state.document.addEventListener("mouseup",t.onMouseUp),i.stopPropagation(),o.clearSelection(n),t.setState({action:new p.MoveItemsAction(i.clientX,i.clientY,e)})}}),r.createElement(c.NodeLayerWidget,{diagramEngine:e}),this.state.action instanceof p.SelectingAction&&this.drawSelectionBox())},DiagramWidget.defaultProps={diagramEngine:null,allowLooseLinks:!0,allowCanvasTranslation:!0,allowCanvasZoom:!0,inverseZoom:!1,maxNumberPointsPerLink:1/0,deleteKeys:[46,8]},DiagramWidget}(r.Component);e.DiagramWidget=h}])});